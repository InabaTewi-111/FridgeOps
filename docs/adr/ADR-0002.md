# ADR-0002: v1 の API は HTTP API（apigatewayv2）を採用し、Contract を固定する

- Status: Accepted
- Date: 2026-02-06
- Supersedes: ADR-0001

## Context
- v1 の優先は「検収できる E2E（apply → verify → destroy）」を成立させること
- 現在の IaC 実装は HTTP API（apigatewayv2）であり、まず実装の一貫性を保つ必要がある
- frontend / Lambda / infra が迷子にならないよう、v1 の API contract を固定したい

## Decision
- API Gateway は HTTP API（apigatewayv2）を採用する
- v1 の API contract は下記に固定する（勝手に変えない）

## Options
- REST API（API Gateway v1）
- HTTP API（API Gateway v2 / apigatewayv2） ← 採用

## Rationale（メモ）
- v1 は「説明可能なクラウド構成＋検収」を最短で作るフェーズ。まず現状 IaC と揃える
- REST の Usage Plan などは“語れる要素”として強いが、v1 の最小検収とは独立なので v2 で体系化すればよい
- 将来 REST が必要になったら、その時点で移行を別 ADR で決める（今は混線させない）

## Consequences
- Terraform は aws_apigatewayv2_* を前提に実装・保守する
- throttling / WAF / budgets / concurrency などの guardrails は v2 で段階導入する余地を残す
- contract 固定により、frontend と Lambda の実装ブレを抑える

## v1 API Contract（Fixed）
Base: /api

### GET /api/items
Response 200:
```json
{
  "items": [
    {
      "id": "<string>",
      "name": "<string>",
      "qty": <number>,
      "unit": "<string>",
      "updatedAt": "<iso8601>"
    }
  ]
}
